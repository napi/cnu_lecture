<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.study.repository.mybatis.CnuRepository">
	<select id="selectCnuPostList" resultType="CnuPost">
		SELECT
			post_id AS postId,
			author,
			password,
			title,
			content,
			create_time AS createTime,
			is_del AS isDel
		FROM
			cnu_post
		WHERE
			is_del = 0
	</select>

	<select id="selectCnuPost" parameterType="int" resultType="CnuPost">
		SELECT
			post_id AS postId,
			author,
			password,
			title,
			content,
			create_time AS createTime,
			is_del AS isDel
		FROM
			cnu_post
		WHERE
			post_id = #{postId}
	</select>

	<insert id="insertCnuPost" parameterType="CnuPost">
		INSERT INTO cnu_post
			(author, password, title, content, create_time)
		VALUES
			(#{author}, #{password}, #{title}, #{content}, NOW())
		<selectKey resultType="int" keyProperty="postId" order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	
	
	<!-- comment  -->
	<insert id="insertCnuPostComment" parameterType="CnuPostComment">
		INSERT INTO cnu_post_comment
			(author, password, comment, create_time)
		VALUES
			(#{author}. #{password}, #{title}, NOW())
		SELECT
			post_id AS postId,
			is_del AS isDel,
			comment_id AS commentId
		FROM
			cnu_post_comment
		WHERE
			post_id = #{postId}
			comment_id = #{comment_id}
			is_del = 0	
		<selectKey resultType="int" keyProperty="commentId" order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
</mapper>
